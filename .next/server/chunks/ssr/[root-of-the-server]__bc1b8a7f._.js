module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},51806,a=>{a.v({nutrients:[{id:"protein",label:"Protein",unit:"g",category:"macronutrient",usda_names:["Protein"]},{id:"carbohydrate",label:"Carbo",unit:"g",category:"macronutrient",usda_names:["Carbohydrate, by difference"]},{id:"fat",label:"Fat",unit:"g",category:"macronutrient",usda_names:["Total lipid (fat)"]},{id:"fiber",label:"Fiber",unit:"g",category:"macronutrient",usda_names:["Fiber, total dietary"]},{id:"calories",label:"Calories",unit:"kcal",category:"macronutrient",usda_names:["Energy"]},{id:"iron",label:"Iron",unit:"mg",category:"mineral",usda_names:["Iron, Fe"]},{id:"calcium",label:"Calcium",unit:"mg",category:"mineral",usda_names:["Calcium, Ca"]},{id:"magnesium",label:"Magnesium",unit:"mg",category:"mineral",usda_names:["Magnesium, Mg"]},{id:"potassium",label:"Potassium",unit:"mg",category:"mineral",usda_names:["Potassium, K"]},{id:"sodium",label:"Sodium",unit:"mg",category:"mineral",usda_names:["Sodium, Na"]},{id:"zinc",label:"Zinc",unit:"mg",category:"mineral",usda_names:["Zinc, Zn"]},{id:"vitamin_a",label:"Vitamin A",unit:"µg",category:"vitamin",usda_names:["Vitamin A, RAE"]},{id:"vitamin_c",label:"Vitamin C",unit:"mg",category:"vitamin",usda_names:["Vitamin C, total ascorbic acid"]},{id:"vitamin_d",label:"Vitamin D",unit:"IU",category:"vitamin",usda_names:["Vitamin D (D2 + D3)"]},{id:"vitamin_e",label:"Vitamin E",unit:"mg",category:"vitamin",usda_names:["Vitamin E (alpha-tocopherol)"]},{id:"vitamin_k",label:"Vitamin K",unit:"µg",category:"vitamin",usda_names:["Vitamin K (phylloquinone)"]},{id:"vitamin_b12",label:"Vitamin B12",unit:"µg",category:"vitamin",usda_names:["Vitamin B-12"]},{id:"folate",label:"Folate",unit:"µg",category:"vitamin",usda_names:["Folate, total"]}]})},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},85595,a=>{"use strict";var b=a.i(8706),c=a.i(64971);async function d(a){let d=(await (0,b.getDB)()).nutrientOverrides??{},e=c.RECOMMENDATION_SETS[a.recommendationSet],f={};for(let b of e.recommendations)("any"===b.sex||b.sex===a.sex)&&a.age>=b.age_min&&a.age<=b.age_max&&(f[b.nutrient_id]=b.daily_value);for(let[a,b]of Object.entries(d))f[a]=b;return f}a.s(["getDailyTargets",()=>d])},82867,81306,a=>{"use strict";let b=a.i(51806).default.nutrients,c=new Map;for(let a of b)for(let b of a.usda_names)c.set(b,a);function d(a){return b.find(b=>b.id===a)}a.s(["getNutrientById",()=>d],81306);var e=a.i(85595),f=a.i(8706);function g(a=new Date){let b=new Date(a),c=(b.getDay()-2+7)%7;b.setDate(b.getDate()-c),b.setHours(0,0,0,0);let d=new Date(b),e=new Date(b);return e.setDate(e.getDate()+7),{start:d.toISOString().slice(0,10),end:e.toISOString().slice(0,10)}}async function h(a,b){let c=new Date().toISOString().slice(0,10);await (0,f.updateDB)(d=>{d.foodLog[c]||(d.foodLog[c]=[]);let e={};for(let[c,d]of Object.entries(a.nutrients??{}))"number"==typeof d&&(e[c]=d*b/100);d.foodLog[c].push({term:a.term,name:a.name,grams:b,nutrientsPer100g:a.nutrients,nutrients:e,loggedAt:Date.now()})})}async function i(a=new Date){await (0,f.initDB)();let b=await (0,f.getDB)();try{console.log("getWeeklyProgress: foodLog keys:",Object.keys(b.foodLog||{}).slice(0,10));let a=Object.keys(b.foodLog||{})[0];a&&console.log("getWeeklyProgress: sample entry:",b.foodLog[a]&&b.foodLog[a][0])}catch(a){console.log("getWeeklyProgress: failed to log sample",a)}let{start:c,end:h}=g(a),j=b.userProfile??{},k={recommendationSet:j.recommendationSet??"fda_dv_2024",sex:j.sex??"female",age:"number"==typeof j.age?j.age:30},l=await (0,e.getDailyTargets)(k),m={};for(let[a,b]of Object.entries(l))m[a]=7*b;let n={};for(let[a,d]of Object.entries(b.foodLog))if(a>=c&&a<h)for(let a of d){if(a.nutrients&&Object.keys(a.nutrients).length){for(let[b,c]of Object.entries(a.nutrients))"number"==typeof c&&(n[b]=(n[b]??0)+c);continue}if(!a.nutrientsPer100g)continue;let b=a.grams/100;for(let[c,d]of Object.entries(a.nutrientsPer100g))"number"==typeof d&&(n[c]=(n[c]??0)+d*b)}let o=[];for(let[a,b]of Object.entries(m)){let c=n[a];if(!c||!b)continue;let e=d(a);e&&o.push({id:a,name:e.label,progress:Math.min(100,Math.round(c/b*100))})}return{overall:Math.round(0===o.length?0:o.reduce((a,b)=>a+b.progress,0)/o.length),all:o,focus:o.filter(a=>a.progress<100).sort((a,b)=>a.progress-b.progress)}}async function j(a,b=new Date){await (0,f.initDB)();let c=await (0,f.getDB)(),{start:h,end:i}=g(b),k=c.userProfile??{},l={recommendationSet:k.recommendationSet??"fda_dv_2024",sex:k.sex??"female",age:"number"==typeof k.age?k.age:30},m=await (0,e.getDailyTargets)(l),n=m[a]?7*m[a]:null;if(!n)return null;let o=d(a);if(!o)return null;let p=0,q={};for(let[b,d]of Object.entries(c.foodLog))if(b>=h&&b<i)for(let b of d){if(b.nutrients&&"number"==typeof b.nutrients[a]){let c=b.nutrients[a];p+=c,q[b.name]=(q[b.name]??0)+c;continue}if(!b.nutrientsPer100g)continue;let c=b.nutrientsPer100g[a];if(!c)continue;let d=b.grams/100*c;p+=d,q[b.name]=(q[b.name]??0)+d}let r=Object.entries(q).map(([a,b])=>({foodName:a,amount:Number(b.toFixed(2))})).sort((a,b)=>b.amount-a.amount).slice(0,5);return{name:o.label,unit:o.unit,intake:Number(p.toFixed(2)),target:n,progress:Math.min(100,Math.round(p/n*100)),contributions:r}}a.s(["getNutrientDetail",()=>j,"getWeeklyProgress",()=>i,"logFood",()=>h],82867)},78890,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246);function e({id:a,name:c,progress:e,compact:f=!1}){return(0,b.jsxs)(d.default,{href:`/nutrients/${a}`,className:`rounded-xl bg-[var(--background)] border border-[var(--border)] ${f?"p-2":"p-4"}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:`font-medium text-[var(--foreground)] ${f?"text-xs":"text-sm"}`,children:c}),(0,b.jsxs)("span",{className:"text-xs text-[var(--foreground)]",children:[e,"%"]})]}),(0,b.jsx)("div",{className:`mt-2 bg-[var(--border)] rounded ${f?"h-1.5":"h-2"}`,children:(0,b.jsx)("div",{className:"bg-[var(--accent)] rounded h-full",style:{width:`${e}%`}})})]})}var f=a.i(81306);function g({value:a}){return(0,b.jsx)("div",{className:"w-40 h-40 rounded-full border-8 border-[var(--border)] flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-3xl font-bold text-[var(--foreground)]",children:[a,"%"]}),(0,b.jsx)("div",{className:"text-xs text-[var(--foreground)]",children:"weekly"})]})})}var h=a.i(82867),i=a.i(75191),j=a.i(39158),k=a.i(50944);let l=/data[-–]theme\s*=\s*"([^"]+)"/g,m=["protein","fat","carbohydrate"],n=["vitamin_a","vitamin_k","vitamin_e","calcium","potassium","zinc","vitamin_c","vitamin_b6","vitamin_b12","fiber","iron","magnesium","sodium","vitamin_d"];function o(){let[a,d]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)([]),{user:s,loading:t}=(0,j.useAuth)(),u=(0,k.useRouter)();if((0,c.useEffect)(()=>{t||s||u.replace("/")},[s,t,u]),(0,c.useEffect)(()=>{let a=localStorage.getItem("theme");a&&(document.documentElement.setAttribute("data-theme",a),p(a))},[]),(0,c.useEffect)(()=>{if(!o){document.documentElement.removeAttribute("data-theme"),localStorage.removeItem("theme");return}document.documentElement.setAttribute("data-theme",o),localStorage.setItem("theme",o)},[o]),(0,c.useEffect)(()=>{(async()=>{try{let a,b=await fetch("/themes.md");if(!b.ok)return;let c=await b.text(),d=new Set;for(;a=l.exec(c);)d.add(a[1]);r(Array.from(d).sort())}catch{}})()},[]),(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,h.getWeeklyProgress)();d(a)}catch{d(null)}})()},[]),t)return null;let v=a?.all??[],w=a=>v.find(b=>b.id===a)??{id:a,name:(0,f.getNutrientById)(a)?.label??a,value:0,goal:0,unit:"",progress:0},x=w("calories"),y=m.map(w),z=n.map(w),A=0===z.length?0:Math.round(z.reduce((a,b)=>a+(b.progress??0),0)/z.length*100)/100;return(0,b.jsxs)("div",{className:"p-4 pb-24 space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("select",{value:o,onChange:a=>p(a.target.value),className:"border rounded px-2 py-1 bg-transparent",children:[(0,b.jsx)("option",{value:"",children:"System"}),q.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})}),(0,b.jsx)("h1",{className:"text-xl font-semibold",children:"This Week"}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h2",{className:"text-sm uppercase text-neutral-400",children:"Macros"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3",children:y.map(a=>(0,b.jsx)(e,{...a},a.id))})]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h2",{className:"text-sm uppercase text-neutral-400",children:"Micros"}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(g,{value:A})}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:z.map(a=>(0,b.jsx)(e,{...a,compact:!0},a.id))})]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h2",{className:"text-sm uppercase text-neutral-400",children:"Calories"}),(0,b.jsx)("div",{className:"grid gap-3",children:(0,b.jsx)(e,{...x})})]}),(0,b.jsx)(i.default,{})]})}a.s(["default",()=>o],78890)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bc1b8a7f._.js.map