{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/usdaSearch.ts"],"sourcesContent":["//app/api/foods/search/route.ts\nexport async function searchUsdaFoods(term: string) {\n  const words = term.trim().toLowerCase().split(/\\s+/).filter(Boolean);\n\n  const res = await fetch(`/api/foods/search?q=${encodeURIComponent(term)}`)\n\n  if (!res.ok) throw new Error('USDA search failed');\n\n  const data = await res.json();\n\n  return (data.foods ?? []).filter((food: any) =>\n    words.some((w) =>\n      food.description?.toLowerCase().includes(w)\n    )\n  );\n}\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;AACxB,eAAe,gBAAgB,IAAY;IAChD,MAAM,QAAQ,KAAK,IAAI,GAAG,WAAW,GAAG,KAAK,CAAC,OAAO,MAAM,CAAC;IAE5D,MAAM,MAAM,MAAM,MAAM,CAAC,oBAAoB,EAAE,mBAAmB,OAAO;IAEzE,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAE7B,MAAM,OAAO,MAAM,IAAI,IAAI;IAE3B,OAAO,CAAC,KAAK,KAAK,IAAI,EAAE,EAAE,MAAM,CAAC,CAAC,OAChC,MAAM,IAAI,CAAC,CAAC,IACV,KAAK,WAAW,EAAE,cAAc,SAAS;AAG/C"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/addUsdaFood.ts"],"sourcesContent":["export async function addUsdaFood(payload: any) {\n    const openAIKey = process.env.NEXT_PUBLIC_OPENAI_API_KEY;\n  if (!openAIKey) {\n    throw new Error('OpenAI API key not set');\n  }\n\n  const res = await fetch('/api/foods/add', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'x-openai-key': openAIKey,\n    },\n    body: JSON.stringify(payload),\n  });\n\n  if (!res.ok) throw new Error('Failed to save food');\n}\n"],"names":[],"mappings":";;;;AACsB;AADf,eAAe,YAAY,OAAY;IAC1C,MAAM;IACR;;IAIA,MAAM,MAAM,MAAM,MAAM,kBAAkB;QACxC,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,gBAAgB;QAClB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;AAC/B"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/app/add/page.tsx"],"sourcesContent":["// app/add/page.tsx\n'use client';\n\nimport { useEffect, useState } from 'react';\nimport { searchUsdaFoods } from '@/lib/usdaSearch';\nimport { addUsdaFood } from '@/lib/addUsdaFood';\n\ntype Nutrients = {\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n};\n\ntype UsdaFood = {\n  fdcId: number;\n  description: string;\n  brandName?: string;\n  foodNutrients?: any[];\n};\n\nfunction ManualForm() {\n  const [name, setName] = useState('');\n  const [measurement, setMeasurement] = useState('');\n  const [nutrients, setNutrients] = useState<Nutrients>({\n    calories: 0,\n    protein: 0,\n    carbs: 0,\n    fat: 0,\n  });\n\n  const submit = () => {\n    console.log({\n      name,\n      measurement,\n      nutrients,\n    });\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <input\n        className=\"border rounded px-3 py-2 w-full text-[var(--foreground)] bg-[var(--background)]\"\n        placeholder=\"Ingredient name\"\n        value={name}\n        onChange={(e) => setName(e.target.value)}\n      />\n\n      <input\n        className=\"border rounded px-3 py-2 w-full text-[var(--foreground)] bg-[var(--background)]\"\n        placeholder=\"Measurement (e.g. 100 g)\"\n        value={measurement}\n        onChange={(e) => setMeasurement(e.target.value)}\n      />\n\n      <div className=\"grid grid-cols-2 gap-3 text-[var(--foreground)] bg-[var(--background)]\">\n        <NumberInput\n          label=\"Calories\"\n          value={nutrients.calories}\n          onChange={(v) => setNutrients({ ...nutrients, calories: v })}\n        />\n        <NumberInput\n          label=\"Protein (g)\"\n          value={nutrients.protein}\n          onChange={(v) => setNutrients({ ...nutrients, protein: v })}\n        />\n        <NumberInput\n          label=\"Carbs (g)\"\n          value={nutrients.carbs}\n          onChange={(v) => setNutrients({ ...nutrients, carbs: v })}\n        />\n        <NumberInput\n          label=\"Fat (g)\"\n          value={nutrients.fat}\n          onChange={(v) => setNutrients({ ...nutrients, fat: v })}\n        /> \n      </div>\n\n      <button\n        onClick={submit}\n        className=\"bg-[var(--foreground)] text-[var(--background)] px-4 py-2 rounded\"\n      >\n        Add Ingredient\n      </button>\n    </div>\n  );\n}\n\nfunction NumberInput({\n  label,\n  value,\n  onChange,\n}: {\n  label: string;\n  value: number;\n  onChange: (v: number) => void;\n}) {\n  return (\n    <label className=\"text-sm space-y-1\">\n      <span>{label}</span>\n      <input\n        type=\"number\"\n        className=\"border rounded px-3 py-2 w-full\"\n        value={value}\n        onChange={(e) => onChange(Number(e.target.value))}\n      />\n    </label>\n  );\n}\n\nexport default function AddIngredientPage() {\n  const [mode, setMode] = useState<'usda' | 'manual'>('usda');\n\n  return (\n    <div className=\"max-w-3xl mx-auto p-6 space-y-6\">\n      <h1 className=\"text-2xl font-semibold\">Add Ingredient</h1>\n\n      <div className=\"flex gap-2\">\n        <button\n          onClick={() => setMode('usda')}\n          className={`px-4 py-2 rounded ${\n            mode === 'usda' ? 'bg-[var(--foreground)] text-[var(--background)]' : 'bg-[var(--background)] text-[var(--foreground)]'\n          }`}\n        >\n          Search USDA\n        </button>\n        <button\n          onClick={() => setMode('manual')}\n          className={`px-4 py-2 rounded ${\n            mode === 'manual' ? 'bg-[var(--foreground)] text-[var(--background)]' : 'bg-[var(--background)] text-[var(--foreground)]'\n          }`}\n        >\n          Manual Entry\n        </button>\n      </div>\n\n      {mode === 'usda' ? <UsdaSearch /> : <ManualForm />}\n    </div>\n  );\n}\n\nfunction UsdaSearch() {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<any[]>([]);\n  const [searching, setSearching] = useState(false);\n  const [addingId, setAddingId] = useState<string | null>(null);\n  const [message, setMessage] = useState<string | null>(null);\n\n  const runSearch = async () => {\n    if (!query.trim()) return;\n    setSearching(true);\n    setResults([]);\n    const foods = await searchUsdaFoods(query);\n    setResults(foods);\n    setSearching(false);\n  };\n\n  const addFood = async (food: any) => {\n    setAddingId(String(food.fdcId));\n    setMessage('Food is being added…');\n\n    try {\n      await addUsdaFood({\n        food,\n        measurement: 'grams',\n        term: query,\n      });\n\n      setMessage('Food added successfully');\n    } catch {\n      setMessage('Failed to add food');\n    } finally {\n      setAddingId(null);\n      setTimeout(() => setMessage(null), 2000);\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex gap-2\">\n        <input\n          className=\"border rounded px-3 py-2 flex-1 text-[var(--foreground)] bg-[var(--background)]\"\n          placeholder=\"Search food\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n          onKeyDown={(e) => e.key === 'Enter' && runSearch()}\n        />\n        <button\n          onClick={runSearch}\n          disabled={searching}\n          className=\"bg-[var(--foreground)] text-[var(--background)] px-4 py-2 rounded disabled:opacity-50\"\n        >\n          {searching ? 'Searching…' : 'Search'}\n        </button>\n      </div>\n\n      {message && (\n        <p className=\"text-sm text-[var(--foreground)]\">{message}</p>\n      )}\n\n      <ul className=\"space-y-2\">\n        {results.map((food) => {\n          const isAdding = addingId === String(food.fdcId);\n\n          return (\n            <li\n              key={food.fdcId}\n              className=\"border rounded p-3 flex justify-between items-center\"\n            >\n              <div>\n                <p className=\"font-medium\">{food.description}</p>\n                <p className=\"text-sm text-[var(--foreground)]\">\n                  {food.brandName ?? 'USDA'}\n                </p>\n              </div>\n\n              <button\n                onClick={() => addFood(food)}\n                disabled={isAdding}\n                className=\"text-sm underline disabled:opacity-50\"\n              >\n                {isAdding ? 'Adding…' : 'Add'}\n              </button>\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}