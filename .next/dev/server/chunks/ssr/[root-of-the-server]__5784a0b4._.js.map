{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/components/NutrientCard.tsx"],"sourcesContent":["// app/components/NutrientCard.tsx\nimport Link from \"next/link\";\n\ntype Props = {\n  id: string;\n  name: string;\n  progress: number;\n  compact?: boolean;\n};\n\nexport default function NutrientCard({\n  id,\n  name,\n  progress,\n  compact = false,\n}: Props) {\n  // components/NutrientCard.tsx\n  return (\n    <Link\n      href={`/nutrients/${id}`}\n      className={`rounded-xl bg-[var(--background)] border border-[var(--border)] ${\n        compact ? \"p-2\" : \"p-4\"\n      }`}\n    >\n      <div className=\"flex justify-between items-center\">\n        <span\n          className={`font-medium text-[var(--foreground)] ${\n            compact ? \"text-xs\" : \"text-sm\"\n          }`}\n        >\n          {name}\n        </span>\n\n        <span className=\"text-xs text-[var(--foreground)]\">\n          {progress}%\n        </span>\n      </div>\n\n      <div\n        className={`mt-2 bg-[var(--border)] rounded ${\n          compact ? \"h-1.5\" : \"h-2\"\n        }`}\n      >\n        <div\n          className=\"bg-[var(--accent)] rounded h-full\"\n          style={{ width: `${progress}%` }}\n        />\n      </div>\n    </Link>\n  );\n\n}\n"],"names":[],"mappings":";;;;;AAAA,kCAAkC;AAClC;;;AASe,SAAS,aAAa,EACnC,EAAE,EACF,IAAI,EACJ,QAAQ,EACR,UAAU,KAAK,EACT;IACN,8BAA8B;IAC9B,qBACE,8OAAC,uKAAI;QACH,MAAM,CAAC,WAAW,EAAE,IAAI;QACxB,WAAW,CAAC,gEAAgE,EAC1E,UAAU,QAAQ,OAClB;;0BAEF,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,WAAW,CAAC,qCAAqC,EAC/C,UAAU,YAAY,WACtB;kCAED;;;;;;kCAGH,8OAAC;wBAAK,WAAU;;4BACb;4BAAS;;;;;;;;;;;;;0BAId,8OAAC;gBACC,WAAW,CAAC,gCAAgC,EAC1C,UAAU,UAAU,OACpB;0BAEF,cAAA,8OAAC;oBACC,WAAU;oBACV,OAAO;wBAAE,OAAO,GAAG,SAAS,CAAC,CAAC;oBAAC;;;;;;;;;;;;;;;;;AAMzC"}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/components/ProgressRing.tsx"],"sourcesContent":["type Props = {\n  value: number;\n};\n\nexport default function ProgressRing({ value }: Props) {\n  return (\n    <div className=\"w-40 h-40 rounded-full border-8 border-[var(--border)] flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"text-3xl font-bold text-[var(--foreground)]\">{value}%</div>\n        <div className=\"text-xs text-[var(--foreground)]\">weekly</div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAIe,SAAS,aAAa,EAAE,KAAK,EAAS;IACnD,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;wBAA+C;wBAAM;;;;;;;8BACpE,8OAAC;oBAAI,WAAU;8BAAmC;;;;;;;;;;;;;;;;;AAI1D"}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/data/nutrients.json"],"sourcesContent":["{\"nutrients\":[{\"id\":\"protein\",\"label\":\"Protein\",\"unit\":\"g\",\"category\":\"macronutrient\",\"usda_names\":[\"Protein\"]},{\"id\":\"carbohydrate\",\"label\":\"Carbo\",\"unit\":\"g\",\"category\":\"macronutrient\",\"usda_names\":[\"Carbohydrate, by difference\"]},{\"id\":\"fat\",\"label\":\"Fat\",\"unit\":\"g\",\"category\":\"macronutrient\",\"usda_names\":[\"Total lipid (fat)\"]},{\"id\":\"fiber\",\"label\":\"Fiber\",\"unit\":\"g\",\"category\":\"macronutrient\",\"usda_names\":[\"Fiber, total dietary\"]},{\"id\":\"calories\",\"label\":\"Calories\",\"unit\":\"kcal\",\"category\":\"macronutrient\",\"usda_names\":[\"Energy\"]},{\"id\":\"iron\",\"label\":\"Iron\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Iron, Fe\"]},{\"id\":\"calcium\",\"label\":\"Calcium\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Calcium, Ca\"]},{\"id\":\"magnesium\",\"label\":\"Magnesium\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Magnesium, Mg\"]},{\"id\":\"potassium\",\"label\":\"Potassium\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Potassium, K\"]},{\"id\":\"sodium\",\"label\":\"Sodium\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Sodium, Na\"]},{\"id\":\"zinc\",\"label\":\"Zinc\",\"unit\":\"mg\",\"category\":\"mineral\",\"usda_names\":[\"Zinc, Zn\"]},{\"id\":\"vitamin_a\",\"label\":\"Vitamin A\",\"unit\":\"µg\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin A, RAE\"]},{\"id\":\"vitamin_c\",\"label\":\"Vitamin C\",\"unit\":\"mg\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin C, total ascorbic acid\"]},{\"id\":\"vitamin_d\",\"label\":\"Vitamin D\",\"unit\":\"IU\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin D (D2 + D3)\"]},{\"id\":\"vitamin_e\",\"label\":\"Vitamin E\",\"unit\":\"mg\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin E (alpha-tocopherol)\"]},{\"id\":\"vitamin_k\",\"label\":\"Vitamin K\",\"unit\":\"µg\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin K (phylloquinone)\"]},{\"id\":\"vitamin_b12\",\"label\":\"Vitamin B12\",\"unit\":\"µg\",\"category\":\"vitamin\",\"usda_names\":[\"Vitamin B-12\"]},{\"id\":\"folate\",\"label\":\"Folate\",\"unit\":\"µg\",\"category\":\"vitamin\",\"usda_names\":[\"Folate, total\"]}]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 121, "column": 1910}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/nutrientRegistry.ts"],"sourcesContent":["// this file handles nutrients data format for food\nimport nutrientData from \"@/data/nutrients.json\";\n\nexport type NutrientDef = {\n  id: string;\n  label: string;\n  unit: string;\n  usda_names: string[];\n};\n\nconst nutrients: NutrientDef[] = nutrientData.nutrients;\n\n// Map USDA name → nutrient ID\nconst usdaNameToId = new Map<string, NutrientDef>();\n\nfor (const n of nutrients) {\n  for (const name of n.usda_names) {\n    usdaNameToId.set(name, n);\n  }\n}\n\nexport function getNutrientByUsdaName(name: string): NutrientDef | undefined {\n  return usdaNameToId.get(name);\n}\n\nexport function getNutrientById(id: string): NutrientDef | undefined {\n  return nutrients.find(n => n.id === id);\n}"],"names":[],"mappings":";;;;;;AAAA,mDAAmD;AACnD;;AASA,MAAM,YAA2B,oGAAY,CAAC,SAAS;AAEvD,8BAA8B;AAC9B,MAAM,eAAe,IAAI;AAEzB,KAAK,MAAM,KAAK,UAAW;IACzB,KAAK,MAAM,QAAQ,EAAE,UAAU,CAAE;QAC/B,aAAa,GAAG,CAAC,MAAM;IACzB;AACF;AAEO,SAAS,sBAAsB,IAAY;IAChD,OAAO,aAAa,GAAG,CAAC;AAC1B;AAEO,SAAS,gBAAgB,EAAU;IACxC,OAAO,UAAU,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AACtC"}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/userProfile.ts"],"sourcesContent":["import type { RecommendationSetId } from \"@/data/recommendations\";\n\nexport type UserProfile = {\n  recommendationSet: RecommendationSetId;\n  sex: \"male\" | \"female\";\n  age: number;\n};\n\nlet userProfile: UserProfile = {\n  recommendationSet: \"fda_dv_2024\",\n  sex: \"female\",\n  age: 30,\n};\n\nexport function getUserProfile(): UserProfile {\n  return userProfile;\n}\n\nexport function updateUserProfile(update: Partial<UserProfile>) {\n  userProfile = { ...userProfile, ...update };\n}\n"],"names":[],"mappings":";;;;;;AAQA,IAAI,cAA2B;IAC7B,mBAAmB;IACnB,KAAK;IACL,KAAK;AACP;AAEO,SAAS;IACd,OAAO;AACT;AAEO,SAAS,kBAAkB,MAA4B;IAC5D,cAAc;QAAE,GAAG,WAAW;QAAE,GAAG,MAAM;IAAC;AAC5C"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/recommendationEngine.ts"],"sourcesContent":["import { getDB } from \"@/lib/db\";\nimport {\n  RECOMMENDATION_SETS,\n  type RecommendationSetId,\n} from \"@/data/recommendations\";\n\ntype Sex = \"male\" | \"female\";\n\nexport type Profile = {\n  recommendationSet: RecommendationSetId;\n  sex: Sex;\n  age: number;\n};\n\nexport async function getDailyTargets(\n  profile: Profile\n): Promise<Record<string, number>> {\n  const db = await getDB();\n  const overrides = db.nutrientOverrides ?? {};\n\n  const set = RECOMMENDATION_SETS[profile.recommendationSet];\n  const targets: Record<string, number> = {};\n\n  for (const r of set.recommendations) {\n    if (\n      (r.sex === \"any\" || r.sex === profile.sex) &&\n      profile.age >= r.age_min &&\n      profile.age <= r.age_max\n    ) {\n      targets[r.nutrient_id] = r.daily_value;\n    }\n  }\n\n  // overrides always win\n  for (const [id, value] of Object.entries(overrides)) {\n    targets[id] = value as number;\n  }\n\n  return targets;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAaO,eAAe,gBACpB,OAAgB;IAEhB,MAAM,KAAK,MAAM,IAAA,kHAAK;IACtB,MAAM,YAAY,GAAG,iBAAiB,IAAI,CAAC;IAE3C,MAAM,MAAM,uJAAmB,CAAC,QAAQ,iBAAiB,CAAC;IAC1D,MAAM,UAAkC,CAAC;IAEzC,KAAK,MAAM,KAAK,IAAI,eAAe,CAAE;QACnC,IACE,CAAC,EAAE,GAAG,KAAK,SAAS,EAAE,GAAG,KAAK,QAAQ,GAAG,KACzC,QAAQ,GAAG,IAAI,EAAE,OAAO,IACxB,QAAQ,GAAG,IAAI,EAAE,OAAO,EACxB;YACA,OAAO,CAAC,EAAE,WAAW,CAAC,GAAG,EAAE,WAAW;QACxC;IACF;IAEA,uBAAuB;IACvB,KAAK,MAAM,CAAC,IAAI,MAAM,IAAI,OAAO,OAAO,CAAC,WAAY;QACnD,OAAO,CAAC,GAAG,GAAG;IAChB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/lib/nutritionEngine.ts"],"sourcesContent":["// lib/nutritionEngine.ts — Firebase-compatible, no React hooks\n\nimport { getNutrientById } from \"@/lib/nutrientRegistry\";\nimport { getUserProfile } from \"@/lib/userProfile\";\nimport { getDailyTargets } from \"@/lib/recommendationEngine\";\nimport { getDB, initDB, updateDB } from \"@/lib/db\";\n\n\n/**\n * CONFIG\n * 1 = Sunday, 2 = Monday\n * MUST match History page\n */\nexport const WEEK_START = 2;\n\n// ---------- Types ----------\nexport type NutrientContribution = {\n  foodName: string;\n  amount: number;\n};\n\nexport type NutrientDetail = {\n  name: string;\n  unit: string;\n  intake: number;\n  target: number;\n  progress: number;\n  contributions: NutrientContribution[];\n};\n\nexport type NutrientProgress = {\n  id: string;\n  name: string;\n  progress: number;\n};\n\nexport type WeeklyProgress = {\n  overall: number;\n  all: NutrientProgress[];\n  focus: NutrientProgress[];\n};\n\nexport type FoodNutrientsPer100g = Record<string, number>;\n\nexport type LoggedFood = {\n  term: string;\n  name: string;\n  grams: number;\n  nutrientsPer100g: FoodNutrientsPer100g;\n  loggedAt: number;\n};\n\n// ---------- Week Helpers ----------\nfunction getWeekRange(baseDate: Date = new Date()) {\n  const d = new Date(baseDate);\n  const diff = (d.getDay() - WEEK_START + 7) % 7;\n  d.setDate(d.getDate() - diff);\n  d.setHours(0, 0, 0, 0);\n\n  const start = new Date(d);\n  const end = new Date(d);\n  end.setDate(end.getDate() + 7);\n\n  return {\n    start: start.toISOString().slice(0, 10),\n    end: end.toISOString().slice(0, 10),\n  };\n}\n\nfunction isWithinWeek(dateIso: string, startIso: string, endIso: string) {\n  return dateIso >= startIso && dateIso < endIso;\n}\n\n// ---------- Core Logic ----------\nexport async function logFood(\n  food: {\n    term: string;\n    name: string;\n    nutrients: Record<string, number>;\n  },\n  grams: number\n) {\n  const date = new Date().toISOString().slice(0, 10);\n\n  await updateDB((db) => {\n    if (!db.foodLog[date]) db.foodLog[date] = [];\n    db.foodLog[date].push({\n      term: food.term,\n      name: food.name,\n      grams,\n      nutrientsPer100g: food.nutrients,\n      loggedAt: Date.now(),\n    });\n  });\n}\n\n// ---------- Weekly Progress ----------\nexport async function getWeeklyProgress(\n  baseDate: Date = new Date()\n): Promise<WeeklyProgress> {\n  await initDB();\n  const db = await getDB();\n\n  const { start, end } = getWeekRange(baseDate);\n  const profile = getUserProfile();\n  const dailyTargets = await getDailyTargets(profile);\n\n  const weeklyTargets: Record<string, number> = {};\n  for (const [id, daily] of Object.entries(dailyTargets)) {\n    weeklyTargets[id] = daily * 7;\n  }\n\n  const totals: Record<string, number> = {};\n\n  for (const [date, foods] of Object.entries(db.foodLog)) {\n    if (!isWithinWeek(date, start, end)) continue;\n\n    for (const entry of foods as LoggedFood[]) {\n      if (!entry.nutrientsPer100g) continue;\n\n      const factor = entry.grams / 100;\n\n      for (const [nutrientId, per100g] of Object.entries(\n        entry.nutrientsPer100g\n      )) {\n        totals[nutrientId] =\n          (totals[nutrientId] ?? 0) + per100g * factor;\n      }\n    }\n  }\n\n\n  const all: NutrientProgress[] = [];\n\n  for (const [nutrientId, target] of Object.entries(weeklyTargets)) {\n    const intake = totals[nutrientId];\n    if (!intake || !target) continue;\n\n    const def = getNutrientById(nutrientId);\n    if (!def) continue;\n\n    all.push({\n      id: nutrientId,\n      name: def.label,\n      progress: Math.min(\n        100,\n        Math.round((intake / target) * 100)\n      ),\n    });\n  }\n\n  const overall =\n    all.length === 0\n      ? 0\n      : all.reduce((s, n) => s + n.progress, 0) / all.length;\n\n  return {\n    overall: Math.round(overall),\n    all,\n    focus: all\n      .filter((n) => n.progress < 100)\n      .sort((a, b) => a.progress - b.progress),\n  };\n}\n\n// ---------- Nutrient Detail ----------\nexport async function getNutrientDetail(\n  nutrientId: string,\n  baseDate: Date = new Date()\n): Promise<NutrientDetail | null> {\n  await initDB();\n  const db = await getDB();\n\n  const { start, end } = getWeekRange(baseDate);\n  const profile = getUserProfile();\n  const dailyTargets = await getDailyTargets(profile);\n\n  const target = dailyTargets[nutrientId]\n    ? dailyTargets[nutrientId] * 7\n    : null;\n  if (!target) return null;\n\n  const def = getNutrientById(nutrientId);\n  if (!def) return null;\n\n  let total = 0;\n  const grouped: Record<string, number> = {};\n\n  for (const [date, foods] of Object.entries(db.foodLog)) {\n    if (!isWithinWeek(date, start, end)) continue;\n\n    for (const entry of foods as LoggedFood[]) {\n      if (!entry.nutrientsPer100g) continue;\n\n      const per100g = entry.nutrientsPer100g[nutrientId];\n      if (!per100g) continue;\n\n      const amount = (entry.grams / 100) * per100g;\n      total += amount;\n\n      grouped[entry.name] =\n        (grouped[entry.name] ?? 0) + amount;\n    }\n  }\n\n  const contributions = Object.entries(grouped)\n    .map(([foodName, amount]) => ({\n      foodName,\n      amount: Number(amount.toFixed(2)),\n    }))\n    .sort((a, b) => b.amount - a.amount)\n    .slice(0, 5);\n\n  return {\n    name: def.label,\n    unit: def.unit,\n    intake: Number(total.toFixed(2)),\n    target,\n    progress: Math.min(\n      100,\n      Math.round((total / target) * 100)\n    ),\n    contributions,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 334, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/components/BottomNav.tsx"],"sourcesContent":["import Link from \"next/link\";\nimport { signOut } from \"firebase/auth\";\nimport { auth } from \"@/lib/firebase\";\n\nfunction logoutHandler () {\n  signOut(auth);\n  window.location.href = \"/\"; // Redirect to login page\n}\n\nexport default function BottomNav() {\n  return (\n    <nav className=\"fixed bottom-0 left-0 right-0 bg-[var(--background)] border-t border-[var(--border)]\">\n      <div className=\"max-w-md mx-auto flex justify-around py-3\">\n        <Link href=\"/\">Home</Link>\n        <Link href=\"/log\">Log</Link>\n        <Link href=\"/history\">History</Link>\n        <Link href=\"/recommendations\">Recommendations</Link>\n        <Link href=\"/add\">Add</Link>\n        <button onClick={logoutHandler}>Logout</button>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;;;;;AAEA,SAAS;IACP,IAAA,6KAAO,EAAC,uHAAI;IACZ,OAAO,QAAQ,CAAC,IAAI,GAAG,KAAK,yBAAyB;AACvD;AAEe,SAAS;IACtB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC,uKAAI;oBAAC,MAAK;8BAAI;;;;;;8BACf,8OAAC,uKAAI;oBAAC,MAAK;8BAAO;;;;;;8BAClB,8OAAC,uKAAI;oBAAC,MAAK;8BAAW;;;;;;8BACtB,8OAAC,uKAAI;oBAAC,MAAK;8BAAmB;;;;;;8BAC9B,8OAAC,uKAAI;oBAAC,MAAK;8BAAO;;;;;;8BAClB,8OAAC;oBAAO,SAAS;8BAAe;;;;;;;;;;;;;;;;;AAIxC"}},
    {"offset": {"line": 439, "column": 0}, "map": {"version":3,"sources":["file:///Users/hung.doan/Documents/GitHubPersonal/nutrition-app/app/home/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport NutrientCard from \"@/components/NutrientCard\";\nimport ProgressRing from \"@/components/ProgressRing\";\nimport { getWeeklyProgress, type WeeklyProgress } from \"@/lib/nutritionEngine\";\nimport BottomNav from \"@/components/BottomNav\";\nimport { useAuth } from \"@/app/providers/AuthProviders\";\nimport { useRouter } from \"next/navigation\";\n\ntype Theme = string;\n\nconst THEME_REGEX = /data[-–]theme\\s*=\\s*\"([^\"]+)\"/g;\n\nconst MACROS = [\"Protein\", \"Fat\", \"Carbs\"];\nconst MICROS = [\n  \"Vitamin A\",\n  \"Vitamin K\",\n  \"Vitamin E\",\n  \"Calcium\",\n  \"Potassium\",\n  \"Zinc\",\n  \"Vitamin C\",\n  \"Vitamin B6\",\n  \"Vitamin B12\",\n  \"Fiber\",\n  \"Iron\",\n  \"Magnesium\",\n  \"Sodium\",\n  \"Vitamin D\",\n];\n\nexport default function HomePage() {\n  const [progress, setProgress] = useState<WeeklyProgress | null>(null);\n  const [theme, setTheme] = useState<Theme>(\"\");\n  const [themes, setThemes] = useState<Theme[]>([]);\n\n  const { user, loading } = useAuth();\n  const router = useRouter();\n\n  useEffect(() => {\n    if (!loading && !user) {\n      router.replace(\"/\");\n    }\n  }, [user, loading, router]);\n\n  useEffect(() => {\n    const saved = localStorage.getItem(\"theme\");\n    if (saved) {\n      document.documentElement.setAttribute(\"data-theme\", saved);\n      setTheme(saved);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!theme) {\n      document.documentElement.removeAttribute(\"data-theme\");\n      localStorage.removeItem(\"theme\");\n      return;\n    }\n\n    document.documentElement.setAttribute(\"data-theme\", theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  useEffect(() => {\n    const loadThemes = async () => {\n      try {\n        const res = await fetch(\"/themes.md\");\n        if (!res.ok) return;\n\n        const text = await res.text();\n        const found = new Set<string>();\n        let match: RegExpExecArray | null;\n\n        while ((match = THEME_REGEX.exec(text))) {\n          found.add(match[1]);\n        }\n\n        setThemes(Array.from(found).sort());\n      } catch {}\n    };\n\n    loadThemes();\n  }, []);\n\n  useEffect(() => {\n    const loadProgress = async () => {\n      try {\n        const data = await getWeeklyProgress();\n        setProgress(data);\n      } catch {\n        setProgress(null);\n      }\n    };\n\n    loadProgress();\n  }, []);\n\n  if (loading) return null;\n\n  const nutrients = progress?.all ?? [];\n\n  const getNutrient = (id: string) =>\n    nutrients.find((n) => n.id === id) ?? {\n      id,\n      name: id,\n      value: 0,\n      goal: 0,\n      unit: \"\",\n      progress: 0,\n    };\n\n  const calories = getNutrient(\"Calories\");\n\n  const macros = MACROS.map(getNutrient);\n  const micros = MICROS.map(getNutrient);\n\n  const microAvg =\n    micros.length === 0\n      ? 0\n      : Math.round(\n          (micros.reduce((sum, n) => sum + (n.progress ?? 0), 0) /\n            micros.length) *\n            100\n        ) / 100;\n\n  return (\n    <div className=\"p-4 pb-24 space-y-6\">\n      <div className=\"flex items-center gap-2\">\n        <select\n          value={theme}\n          onChange={(e) => setTheme(e.target.value)}\n          className=\"border rounded px-2 py-1 bg-transparent\"\n        >\n          <option value=\"\">System</option>\n          {themes.map((t) => (\n            <option key={t} value={t}>\n              {t}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      <h1 className=\"text-xl font-semibold\">This Week</h1>\n\n      <section className=\"space-y-2\">\n        <h2 className=\"text-sm uppercase text-neutral-400\">Macros</h2>\n        <div className=\"grid grid-cols-3 gap-3\">\n          {macros.map((n) => (\n            <NutrientCard key={n.id} {...n} />\n          ))}\n        </div>\n      </section>\n\n      <section className=\"space-y-2\">\n        <h2 className=\"text-sm uppercase text-neutral-400\">Micros</h2>\n        <div className=\"flex justify-center\">\n          <ProgressRing value={microAvg} />\n        </div>\n        <div className=\"grid grid-cols-3 gap-2\">\n          {micros.map((n) => (\n            <NutrientCard key={n.id} {...n} compact />\n          ))}\n        </div>\n      </section>\n\n      <section className=\"space-y-2\">\n        <h2 className=\"text-sm uppercase text-neutral-400\">Calories</h2>\n          <div className=\"grid gap-3\">\n            <NutrientCard {...calories} />\n          </div>\n      </section>\n\n      <BottomNav />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}